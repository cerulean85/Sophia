- AWS에서 네트워크 계층에서 발생하는 연결을 차단하려면, 네트워크 계층의 보안 서비스를 사용해야 ㅎㅁ
    - 이를 위해 다양한 서비스와 기능을 활용할 수 있으며, 대표적인 서비스는 보안 그룹(Security Groups), 네트워크 ACL(Network ACLs), VPC 엔드포인트, 그리고 AWS Network Firewall 등이 있음


## 1. 보안 그룹(Security Groups)
- 인스턴스 수준에서 동작하는 방화벽
- EC2 인스턴스나 RDS 등과 같은 AWS 리소스의 인바운드(Inbound) 및 아웃바운드(Outbound) 트래픽을 제어
- **상태 저장(Stateful)**이므로, 허용된 인바운드 트래픽에 대한 아웃바운드 응답은 자동으로 허용
- 특정 IP 주소나 포트에 대해 허용하거나 차단할 수 있으며, 이를 통해 인터넷과 내부 네트워크로부터의 트래픽을 선택적으로 차단할 수 있음

## 2. 네트워크 ACL(Network Access Control Lists)
- 서브넷 수준에서 동작하는 방화벽
- VPC 내부의 서브넷에 대한 인바운드 및 아웃바운드 트래픽을 제어
- **상태 비저장(Stateless)**이므로, 인바운드와 아웃바운드 트래픽에 대해 각각 명시적으로 허용 규칙을 설정해야 함
- 특정 트래픽을 차단하거나 허용하는 규칙을 설정하여 서브넷 전체의 인터넷 접근을 제어할 수 있음

## 3. AWS Network Firewall
- 네트워크 보안을 강화하기 위한 관리형 방화벽 서비스
- VPC 네트워크 전체의 트래픽을 제어하고, 특정 트래픽 패턴을 분석하여 허용하거나 차단할 수 있음
- 상태 저장 방화벽으로 동작하며, IP 필터링, 도메인 이름 필터링, 포트 필터링 등을 통해 정교한 네트워크 보안 규칙을 적용할 수 있음
- 복잡한 네트워크 트래픽 정책이 필요한 경우 AWS Network Firewall을 사용하여 트래픽을 차단하거나 허용할 수 있음

## 4. VPC 엔드포인트(VPC Endpoints)
- 인터넷 게이트웨이나 NAT 게이트웨이를 사용하지 않고도 VPC에서 AWS 서비스에 안전하게 연결할 수 있게 해줌
- VPC 내부에서 인터넷 없이도 S3나 DynamoDB 같은 AWS 서비스에 접근할 수 있도록 하며, 이로써 인터넷에 대한 의존성을 줄이고 보안을 강화할 수 있음
- VPC 엔드포인트를 사용하면, 인터넷을 통한 연결을 피하면서 내부적으로 안전하게 AWS 리소스에 접근할 수 있음

## 5. 인터넷 게이트웨이(Internet Gateway) 및 NAT 게이트웨이(NAT Gateway) 설정
- 인터넷 접근을 차단하려면, 인터넷 게이트웨이를 VPC에 추가하지 않거나, 추가된 경우 제거하면 됨
- 또한, 프라이빗 서브넷을 사용하고 NAT 게이트웨이를 설정하면, 내부 리소스가 아웃바운드 인터넷 트래픽만 허용되고, 외부로부터의 인바운드 트래픽은 차단할 수 있음

## 6. AWS Shield 및 AWS Global Accelerator (추가적인 보호)
- AWS Shield: 주로 DDoS 공격으로부터 보호하기 위한 서비스로, 네트워크 계층에서 발생하는 대규모 트래픽 공격을 차단할 수 있음
- AWS Global Accelerator: 애플리케이션 트래픽을 최적화하고 보호하며, 특정 네트워크 경로를 통해 애플리케이션을 보호할 수 있음


## 7. NACL vs. Security Group
- NACL은 **상태 비저장(Stateless)**
    - 예를 들어, 80번 포트에 대한 인바운드 규칙이 Allow더라도,
    - 동일한 80번 포트에 대해 아웃바운드 규칙이 인바운드 규칙과 동일하게 적용되지 않음
    - 즉, 80번 포트에 대한 아웃바운드 규칙을 별도로 만들어야 함

- NACL은 Security Group과 다르게 **Deny 규칙도 생성할 수 있음**
- Security Group이 EC2 인스턴스의 접근 제어 목록이라면, NACL은 Subnet을 오고 가는 모든 트래픽을 제어함
- 인스턴스에는 여러 개의 Security Group을 적용할 수 있으나, 서브넷에는 하나의 NACL만 적용 가능

- NACL은 규칙의 번호가 작은 순서가 우선으로 적용됨
    - 예를 들어, 100번의 규칙이 80번 포트를 Allow하고,
    - 그 다음 101번 규칙이 모든 포트(0~65535)를 Deny하였다면,
    - 101번의 80번의 포트만 제외한 Deny 규칙은 무시됨